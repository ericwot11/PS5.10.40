<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploit PS5 Payload Interface</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Interface de contrôle de l'exploit PS5</h1>

    <div id="controls">
        <!-- Bouton pour démarrer l'exploit WebKit et la chaîne ROP -->
        <button onclick="startExploit()">Démarrer l'exploit WebKit et ROP</button>

        <!-- Sélection de fichier ELF pour injection -->
        <div>
            <label for="payloadFile">Choisir un fichier payload ELF :</label>
            <input type="file" id="payloadFile" accept=".elf">
            <button onclick="injectSelectedPayload()">Injecter le payload ELF</button>
        </div>

        <!-- Bouton pour extraire les données du kernel -->
        <button onclick="extractKernel()">Extraction des données kernel</button>
    </div>

    <!-- Affichage des logs d'exécution -->
    <div id="log-container">
        <h2>Logs d'exécution</h2>
        <pre id="logs"></pre>
    </div>

    <script src="exploit.js"></script>
    <script>
        // Fonction pour démarrer l'exploit complet
        function startExploit() {
            logMessage("Lancement de l'exploit WebKit...");
            startWebKitExploit()
                .then(() => {
                    logMessage("Exploit WebKit réussi, passage à la chaîne ROP.");
                    initializeROPChain();
                })
                .catch(err => logMessage("Erreur : " + err));
        }

        // Fonction pour injecter un payload ELF sélectionné
        function injectSelectedPayload() {
            const fileInput = document.getElementById("payloadFile");
            const file = fileInput.files[0];

            if (!file) {
                logMessage("Aucun fichier ELF sélectionné.");
                return;
            }

            const reader = new FileReader();
            reader.onload = function () {
                logMessage("Injection du payload ELF en cours...");
                injectELFPayload(reader.result, 0x300000);  // Adresse mémoire allouée
            };
            reader.readAsArrayBuffer(file);
        }

        // Fonction pour extraire des données critiques du kernel
        function extractKernel() {
            logMessage("Extraction des données du kernel en cours...");
            extractKernelData();
        }

        // Fonction pour afficher les messages de log
        function logMessage(message) {
            const logs = document.getElementById("logs");
            logs.innerText += `[${new Date().toLocaleTimeString()}] ${message}\n`;
        }
    </script>
</body>
</html>
