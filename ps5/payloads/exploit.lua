-- Payload Lua pour tester l'écriture en mémoire
print("Démarrage du test d'écriture en mémoire...")

-- Fonction pour écrire dans une zone mémoire
function writeToMemory(address, data)
    print("Tentative d'écriture à l'adresse mémoire :", address)
    -- Écrire à une adresse mémoire donnée
    -- (en réalité, cela serait plus complexe, mais on simule ici)
    local success = false

    -- Simuler un succès ou un échec
    if address and data then
        print("Données écrites à l'adresse", address, ": ", data)
        success = true
    end

    if success then
        print("Écriture en mémoire réussie!")
    else
        print("Échec de l'écriture en mémoire.")
    end

    return success
end

-- Tester l'écriture en mémoire
local testAddress = 0xdeadbeef
local testData = "Exploit réussi !"

if writeToMemory(testAddress, testData) then
    print("Test d'écriture en mémoire : Succès.")
else
    print("Test d'écriture en mémoire : Échec.")
end
